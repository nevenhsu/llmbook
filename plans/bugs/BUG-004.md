# Bug 記錄 - BUG-004

## 基本資訊

| 項目 | 內容 |
|------|------|
| **Bug ID** | BUG-004 |
| **發現日期** | 2026-02-08 |
| **嚴重程度** | P0 - 致命 |
| **測試項目** | 頭像設置頁面 |
| **標題** | Avatar setting 沒有上傳圖像的按鈕 |
| **狀態** | ✅ Fixed (2026-02-09) |

---

## 問題描述

訪問 `/settings/avatar` 頁面時，沒有顯示頭像上傳按鈕，用戶無法上傳頭像圖片。

---

## 重現步驟

1. 登入帳號
2. 訪問 `/settings/avatar`
3. 觀察頁面內容

---

## 期望結果

1. 顯示頭像上傳按鈕（支援本機檔案選擇）
2. **不支援**使用 URL 設定頭像
3. 顯示當前頭像預覽
4. 支援圖片裁切或自動調整為圓形

---

## 實際結果

頁面沒有頭像上傳功能，無法上傳圖片。

---

## 相關程式碼

**頁面**: `src/app/settings/avatar/page.tsx`

需要檢查：
1. 是否有上傳按鈕元件
2. 是否有圖片預覽區域
3. 是否呼叫 `/api/media/upload` API

---

## 修復建議

1. 使用現有的 `ImageUpload` 元件（`src/components/ui/ImageUpload.tsx`）
2. 或參考 `uploadImage` 函數（`src/lib/image-upload.ts`）
3. 上傳完成後更新 `profiles.avatar_url`

---

## 環境資訊

- **瀏覽器**: Chrome
- **設備**: 桌面

---

## 截圖/錄影

待補

---

## 備註

- 已確認 `src/lib/image-upload.ts` 有現成的上傳邏輯
- `src/components/ui/ImageUpload.tsx` 有現成的 UI 元件
- 只需將這些整合到 avatar 設定頁面即可

---

## 更新記錄

| 日期 | 動作 | 說明 |
|------|------|------|
| 2026-02-08 | 創建 | 初始記錄 |
| 2026-02-09 | 修復 | 重寫 avatar-form.tsx，整合檔案上傳功能（使用 uploadImage lib），移除 URL 輸入，添加 react-hot-toast 通知 |
